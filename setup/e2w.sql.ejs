CREATE DATABASE IF NOT EXISTS <%= db_name %> DEFAULT COLLATE utf8_unicode_ci DEFAULT CHARACTER SET utf8;

use <%= db_name %>;

CREATE TABLE IF NOT EXISTS manager
	(mid INT NOT NULL AUTO_INCREMENT,
	username VARCHAR(50) NOT NULL,
	passwd VARCHAR(50) NOT NULL,
	name VARCHAR(50) NOT NULL,
	PRIMARY KEY (mid))
CHARSET=utf8mb4;

CREATE TABLE IF NOT EXISTS guest
	(gid INT NOT NULL AUTO_INCREMENT, 
	source_ip VARCHAR(50) NOT NULL UNIQUE,
	name VARCHAR(50) NOT NULL,
	timestamp BIGINT(20) NOT NULL,
	PRIMARY KEY (gid))
CHARSET=utf8mb4;

CREATE TABLE IF NOT EXISTS article
	(aid INT NOT NULL AUTO_INCREMENT,
	name VARCHAR(50) NOT NULL UNIQUE,
	abstract VARCHAR(255) NOT NULL,
	content TEXT NOT NULL,
	pid INT NOT NULL,
	is_manager TINYINT(1) NOT NULL,
	timestamp BIGINT(20) NOT NULL,
	PRIMARY KEY (aid))
CHARSET=utf8mb4;

CREATE TABLE IF NOT EXISTS category
	(ctid INT NOT NULL AUTO_INCREMENT,
	name VARCHAR(50) NOT NULL UNIQUE,
	abstract VARCHAR(255) NOT NULL,
	PRIMARY KEY (ctid))
CHARSET=utf8mb4;

CREATE TABLE IF NOT EXISTS article_category
	(acid INT NOT NULL AUTO_INCREMENT,
	aid INT NOT NULL, 
	ctid INT NOT NULL,
	PRIMARY KEY (acid))
CHARSET=utf8mb4;

CREATE TABLE IF NOT EXISTS article_discussion
	(adid INT NOT NULL AUTO_INCREMENT,
	aid INT NOT NULL,
	content TEXT NOT NULL,
	pid INT NOT NULL,
	is_manager TINYINT(1) NOT NULL,
	timestamp BIGINT(20) NOT NULL,
	PRIMARY KEY (adid))
CHARSET=utf8mb4;

CREATE TABLE IF NOT EXISTS article_modifying_record
	(mrid INT NOT NULL AUTO_INCREMENT,
	aid INT NOT NULL,
	comment VARCHAR(255) NOT NULL,
	abstract VARCHAR(255) NOT NULL,
	content TEXT NOT NULL,
	pid INT NOT NULL,
	is_manager TINYINT(1) NOT NULL,
	timestamp BIGINT(20) NOT NULL,
	PRIMARY KEY (mrid))
CHARSET=utf8mb4;
